# 🚀 Notion 同步工具

一个现代化的桌面应用程序，专为高效的 Notion 内容管理而设计。支持将 Notion 页面和数据库导出到本地，提供美观的用户界面和强大的任务管理功能。

## ✨ 主要功能

### 🎯 核心功能
- 📥 **云端到本地同步** - 从 Notion 导出页面和数据库到本地文件夹
- 📄 **多格式支持** - 支持 Markdown、HTML、JSON 等多种导出格式
- 🗂️ **智能任务管理** - 创建、管理和执行多个同步任务
- 👀 **实时状态监控** - 实时显示同步进度和状态
- 🔄 **自动同步** - 支持定时自动同步功能

### 🎨 用户体验
- 💎 **现代化界面** - 遵循 Apple Human Interface Guidelines 的美观设计
- 🌍 **完整中文支持** - 全中文界面，无英文混杂
- 🎭 **主题切换** - 支持明暗主题切换
- 📱 **响应式布局** - 适配不同屏幕尺寸
- ✨ **美观对话框** - 全新设计的任务创建界面，无字体遮挡问题

### 🔧 技术特性
- 🏗️ **MVC 架构** - 清晰的代码结构和模块化设计
- 🗄️ **SQLite 数据库** - 本地数据存储和任务管理
- ⚡ **异步处理** - 非阻塞的同步操作，保持界面响应
- 🛡️ **错误处理** - 完善的错误处理和用户提示
- 📊 **详细日志** - 完整的操作日志记录

## 🚀 快速开始

### 系统要求

- Python 3.9+
- Windows 10/11, macOS 10.15+, 或 Linux

### 安装步骤

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **启动应用**
   ```bash
   python ultimate_start.py
   ```

### 首次使用

1. **获取 Notion API 令牌**
   - 访问 [Notion 集成页面](https://www.notion.so/my-integrations)
   - 点击"新建集成"
   - 填写集成名称并创建
   - 复制生成的"内部集成令牌"
   - 将集成添加到您要同步的 Notion 页面

2. **连接到 Notion**
   - 启动应用后，如果未连接会自动弹出令牌输入对话框
   - 输入您的 API 令牌
   - 点击"连接"等待验证成功
   - 成功后会显示"已连接到云端服务"

3. **创建同步任务**
   - 点击主界面的"创建新任务"按钮
   - 在美观的对话框中选择要同步的 Notion 内容
   - 配置任务名称和本地保存位置
   - 设置同步选项（包含子页面、自动同步等）
   - 点击"创建任务"完成配置

4. **执行同步**
   - 在任务列表中选择要执行的任务
   - 点击"执行任务"开始同步
   - 实时查看同步进度和状态
   - 同步完成后可在本地文件夹查看导出的内容

## 📖 详细使用指南

### 🎯 任务管理界面

#### 创建新任务
1. **打开创建对话框**
   - 点击主界面的"创建新任务"按钮
   - 会打开美观的任务创建对话框

2. **选择 Notion 内容**
   - 左侧面板显示您的 Notion 工作区内容
   - 分为"页面"和"数据库"两个分类
   - 勾选要同步的页面或数据库
   - 支持多选，可同时选择多个项目

3. **配置任务设置**
   - **任务名称**: 为任务起一个有意义的名称
   - **保存位置**: 点击文件夹图标选择本地保存目录
   - **包含子页面**: 是否同步选中页面的子页面
   - **启用自动同步**: 是否定期自动执行此任务

#### 管理现有任务
- **查看任务列表**: 主界面显示所有已创建的任务
- **执行任务**: 选择任务后点击"执行任务"
- **编辑任务**: 双击任务可编辑配置
- **删除任务**: 右键菜单选择删除
- **导入/导出配置**: 菜单栏支持任务配置的导入导出

### 📁 支持的内容类型

#### Notion 页面
- **普通页面**: 包含文本、图片、表格等内容的页面
- **数据库页面**: Notion 数据库中的单个记录
- **子页面**: 页面内嵌套的子页面（可选择是否包含）

#### 导出格式
- **Markdown**: `.md` 文件，保持格式和结构
- **HTML**: `.html` 文件，适合网页展示
- **纯文本**: `.txt` 文件，纯文本内容
- **JSON**: `.json` 文件，包含完整的结构化数据

#### 媒体文件
- **图片**: 自动下载并保存到本地
- **文件附件**: 下载原始文件到本地
- **链接**: 保持原有链接或转换为本地路径

### ⚙️ 应用设置

#### 通用设置
- **语言**: 中文/英文界面切换
- **主题**: 明亮/暗黑主题切换
- **启动**: 开机自启动选项

#### 同步设置
- **自动同步间隔**: 设置自动同步的时间间隔
- **文件大小限制**: 设置单个文件的大小限制
- **并发数量**: 同时进行的同步任务数量

#### 高级设置
- **日志级别**: 调整日志详细程度
- **缓存管理**: 清理缓存和临时文件
- **数据库维护**: 数据库优化和备份

## 🔧 项目架构

### 📁 目录结构
```
src/notion_sync/
├── controllers/           # 🎮 控制器层
│   └── app_controller.py  # 主应用控制器
├── models/               # 📊 数据模型
│   ├── database.py       # 数据库管理
│   └── sync_task.py      # 同步任务模型
├── views/                # 🎨 用户界面
│   ├── main_window.py    # 主窗口
│   ├── task_manager_view.py  # 任务管理界面
│   ├── beautiful_task_dialog.py  # 美观的任务创建对话框
│   └── token_dialog.py   # 令牌输入对话框
├── services/             # 🔧 业务服务
│   ├── notion_client.py  # Notion API 客户端
│   ├── sync_bridge.py    # 同步桥接服务
│   └── file_sync_service.py  # 文件同步服务
└── utils/                # 🛠️ 工具函数
    ├── settings_manager.py   # 设置管理
    ├── error_handler.py     # 错误处理
    └── async_worker.py      # 异步任务处理
```

### 🏗️ 架构设计
- **MVC 模式**: 清晰的模型-视图-控制器分离
- **服务层**: 独立的业务逻辑处理
- **异步处理**: 非阻塞的 UI 和后台任务
- **模块化设计**: 高内聚、低耦合的组件结构

## 🚨 重要注意事项

### 🔐 安全须知
1. **API 令牌安全**
   - 妥善保管您的 Notion API 令牌
   - 不要在公共场所输入令牌
   - 如有泄露请立即撤销并重新生成
   - 令牌会加密存储在本地

2. **权限设置**
   - 确保集成已添加到要同步的 Notion 页面
   - 检查集成是否有足够的读取权限
   - 某些企业工作区可能有额外限制

### 💾 数据安全
1. **备份建议**
   - 首次同步前建议备份重要的本地文件
   - 定期备份 Notion 内容
   - 重要数据建议多地备份

2. **同步范围**
   - 当前版本专注于云端到本地的单向同步
   - 不会修改您的 Notion 内容
   - 本地文件仅用于存储导出内容

### 🌐 网络要求
- 需要稳定的互联网连接
- 大量内容同步可能需要较长时间
- 建议在网络稳定时进行首次同步

## 🐛 故障排除

### ❓ 常见问题

**Q: 无法连接到 Notion**
- 检查网络连接是否正常
- 验证 API 令牌是否正确
- 确认令牌未过期或被撤销
- 检查防火墙设置

**Q: 找不到页面或数据库**
- 确认集成已添加到相应页面
- 检查页面是否为私有页面
- 验证您是否有访问权限

**Q: 同步任务执行失败**
- 查看详细错误日志
- 检查本地文件夹权限
- 确认磁盘空间充足
- 重试或重新创建任务

**Q: 界面显示异常**
- 尝试切换主题
- 重启应用程序
- 检查系统字体设置
- 更新显卡驱动

**Q: 性能问题**
- 减少并发同步任务数量
- 清理应用缓存
- 关闭不必要的后台程序
- 检查系统资源使用情况

## 🎯 开发路线图

### 🚀 已完成功能
- ✅ 基础 Notion API 集成
- ✅ 美观的现代化界面设计
- ✅ 任务管理系统
- ✅ 云端到本地同步
- ✅ 多格式导出支持
- ✅ 完整中文本地化
- ✅ 主题切换功能
- ✅ 错误处理和日志系统

### 🔄 计划中功能
- 🔲 批量任务执行
- 🔲 增量同步优化
- 🔲 更多导出格式支持
- 🔲 同步历史记录
- 🔲 高级过滤选项
- 🔲 插件系统
- 🔲 云端配置同步

### 💡 未来展望
- 🔲 移动端应用
- 🔲 Web 版本
- 🔲 团队协作功能
- 🔲 API 开放平台

## 🛠️ 技术栈

- **界面框架**: PySide6 (Qt6)
- **HTTP 客户端**: httpx
- **数据库**: SQLite
- **异步处理**: asyncio
- **文件监控**: watchdog
- **配置管理**: JSON
- **日志系统**: Python logging

## 📄 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件

## 🤝 参与贡献

我们欢迎各种形式的贡献！

### 🐛 报告问题
- 使用 GitHub Issues 报告 bug
- 提供详细的错误信息和复现步骤
- 包含系统环境和版本信息

### 💡 功能建议
- 在 Issues 中提出新功能建议
- 详细描述功能需求和使用场景
- 讨论实现方案和技术细节

### 🔧 代码贡献
- Fork 项目并创建功能分支
- 遵循现有代码风格和架构
- 添加必要的测试和文档
- 提交 Pull Request

### 📖 文档改进
- 改进用户文档和开发文档
- 翻译文档到其他语言
- 添加使用示例和教程

## 🙏 致谢

感谢所有为这个项目做出贡献的开发者和用户！

特别感谢：
- Notion 团队提供的优秀 API
- Qt/PySide 团队的界面框架
- 开源社区的各种优秀库

---

**🎉 享受高效的 Notion 内容管理体验！**

如果这个工具对您有帮助，请考虑给项目一个 ⭐ Star！
